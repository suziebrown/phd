par(mfrow=c(3,1), mai=c(0.1,0.1,0.1,0.1))
mypink <- "#93004E"

x <- seq(-4.5,by=0.01,2.5)
y = function(x) exp(-4*(x-1)^2) + exp(-((x+1))^2/2)
#init <- runif(12, -4.5, 2.5)

plot(x,y(x),type='l',yaxt='n', xaxt='n', ylab='', xlab='', bty='n', ylim=c(-0.2,1.2))
abline(h=0, col='lightgray')
lines(x,y,type='l')
points(init, rep(0,12), pch=16, col=mypink, cex=2)
#text(-3.3,0.8,"mutation", cex=2, col=mypink)

plot(x,y(x),type='l',yaxt='n', xaxt='n', ylab='', xlab='', bty='n', ylim=c(-0.2,1.2))
abline(h=0, col='lightgray')
lines(x,y,type='l')
points(init, rep(0,12), cex=6*y(init), pch=16, col=mypink)
#text(-3.3,0.8,"fitness", cex=2, col=mypink)

plot(x,y(x),type='l',yaxt='n', xaxt='n', ylab='', xlab='', bty='n', ylim=c(-0.2,1.2))
abline(h=0, col='lightgray')
lines(x,y,type='l')
#counts = rmultinom(1,12,y(init))
points(rep(init[1],1), c(0), pch=16, col=mypink, cex=2)
points(rep(init[3],1), c(0), pch=16, col=mypink, cex=2)
points(rep(init[4],1), c(0), pch=16, col=mypink, cex=2)
points(rep(init[6],2), c(0,0.1), pch=16, col=mypink, cex=2)
points(rep(init[9],1), c(0), pch=16, col=mypink, cex=2)
points(rep(init[10],2), c(0,0.1), pch=16, col=mypink, cex=2)
points(rep(init[12],4), c(0,0.1,0.2,0.3), pch=16, col=mypink, cex=2)
#text(-3.3,0.8,"selection", cex=2, col=mypink)
