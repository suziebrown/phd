\documentclass[final, 12pt]{beamer}
\usepackage[orientation=portrait, size=a1, scale=1.5]{beamerposter}
\usepackage[absolute,overlay]{textpos}
\usetheme{suzie}
\usefonttheme{professionalfonts}

\newlength{\sepwid}
\newlength{\onecolwid}
\newlength{\twocolwid}
\setlength{\paperwidth}{59.4cm}
\setlength{\paperheight}{84.1cm}
%\setlength{\sepwid}{0.008\paperwidth}
\setlength{\onecolwid}{0.28\paperwidth}
\setlength{\twocolwid}{0.435\paperwidth}

\setbeamercolor{block title}{fg=black,bg=white} % Colors of the block titles
\setbeamercolor{block body}{fg=black,bg=white} % Colors of the body of blocks

\newcommand{\trans}{^{\scriptscriptstyle T}}

\title{Hamiltonian Monte Carlo}
\author{Suzie Brown}
\institute{School of Mathematics, University of Bristol}
\date{\today}

\begin{document}
\begin{textblock}{15}(0.5,0.53)
\includegraphics[width=0.2\linewidth]{unilogo.png}
\end{textblock}
\begin{frame}[t]

\begin{columns}[t]
\begin{column}{\twocolwid}
\begin{block}{\LARGE{Generating proposals}}
Hamiltonian Monte Carlo (HMC) generates proposals by simulating Hamiltonian dynamics:
\begin{equation*}
\frac{\partial x}{\partial t}=\frac{\partial \mathcal{H}(x,r)}{\partial r} \qquad \frac{\partial r}{\partial t}=-\frac{\partial \mathcal{H}(x,r)}{\partial x}
\end{equation*}
where the Hamiltonian $\mathcal{H}(x,r)$ is chosen based on the target distribution [1].
% \parencite{neal2011}
In particular, if the target density is $\pi_X$, the Hamiltonian is
\begin{equation*}
\mathcal{H}(x,r) = -\log \pi_X(x) - \log \pi_R(r)
\end{equation*}
where $\pi_R$ is the marginal density of auxiliary momentum variables $R_t$, and can be any distribution on $\mathbb{R}^d$. For convenience $\pi_R$ is usually a $d$-dimensional standard Gaussian distribution, in which case
\begin{equation*}
\mathcal{H}(x,r) = -\log \pi_X(x) + \frac{r\trans r}{2}
\end{equation*}
\vskip1.4cm
The process of choosing a proposal state (at least when $d=2$) can be thought of as follows:\\[0.7cm]
\begin{enumerate}
\item Place a ball on the surface $-\log \pi_X$ at the point $x_t$ (the current state)
\item Give the ball a push in a random direction (this corresponds to choosing a random momentum)
\item Allow the ball to roll over the surface under gravity (this corresponds to simulating Hamiltonian dynamics)
\end{enumerate}
\begin{figure}
\centering
\raisebox{-0.5\height}{\includegraphics[width=0.5\twocolwid]{plot1}}
\raisebox{-0.5\height}{\includegraphics[width=0.4\twocolwid]{lfi2}}
\caption{An example of a trajectory traced out by ``rolling a ball'' on the negative log-likelihood function of a bivariate Gaussian target}
\end{figure}
\vskip0.5cm
Trajectories on $-\log\pi_X$ are drawn toward its minimum, which is the maximum of $\pi_X$. It is therefore intuitive that this process produces more proposals from the higher density region near the mode.\\[0.7cm]

It is impossible to simulate Hamiltonian dynamics exactly: some numerical approximation with discrete time steps must be used. 
The usual method is the ``leapfrog integrator'', which takes two parameters: step size $\varepsilon$ and number of steps $L$. The efficiency of HMC depends strongly on the values of these parameters, so it is important to tune them carefully.\\[0.7cm]

The acceptance probability corrects for any numerical error. If the Hamiltonian dynamics were simulated perfectly, every proposal would be accepted.
\end{block}

\vskip1.2cm
\begin{block}{\LARGE{References}}
\begin{enumerate}
\item Neal, R. M. et al. (2011). MCMC using Hamiltonian dynamics. \textit{Handbook of Markov Chain Monte Carlo, 2}, 113-–162.\\[0.5cm]
%\item Skeel, R. D., Zhang, G., \& Schlick, T. (1997). A family of symplectic integrators: stability, accuracy, and molecular dynamics applications. \textit{SIAM Journal on Scientiﬁc Computing, 18}(1), 203-–222.
\item Betancourt, M. \& Girolami, M. (2013). Hamiltonian Monte Carlo for hierarchical models. \textit{arXiv preprint} arXiv:1312.0906.
\end{enumerate}
\end{block}
\end{column}

\begin{column}{\twocolwid}
\begin{block}{\LARGE{Funnel-shaped distributions}}
Funnel-shaped distributions frequently arise in hierarchical models. Their pathological geometry frustrates most MCMC algorithms.
Take the simple model with priors
\begin{align*}
\theta_i &\sim \mathcal{N}(\mu,e^{-v}) & i=1,...,n\\
v &\sim \mathcal{N}(0,3^2) &
\end{align*}
and observables $X_i$ depending on $\theta_i$ respectively.
The strong dependence between $\theta_i$ and $v$ causes the prior distribution to be funnel-shaped [2].
% parencite{betancourt???}
\vskip0.3cm
\begin{figure}
\centering
\includegraphics[width=0.7\twocolwid]{funneldens4}
\caption{The funnel-shaped prior distribution arising from the above model. Bright regions have high density.}
\end{figure}
\vskip0.5cm
The gradient near the ``spout'' is so large that no reasonable choice of the step size $\varepsilon$ will allow HMC to fully explore the distribution.\\[0.7cm]

The posterior distribution is less funnel-shaped than the prior because the observations provide additional information about $\theta_i$ and $v$.
Also, using the equivalent non-centred parametrisation for $\theta_i$
\begin{align*}
\theta_i &=\mu+ e^{-v/2}\,\varphi_i & i=1,...,n\\
\varphi_i &\sim \mathcal{N}(0,1) & i=1,...,n
\end{align*}
mitigates the funnel geometry by making $\theta_i$ and $v$ independent conditional on the observations.
With these alterations, HMC is able to explore the target distribution effectively.\\[0.7cm]

The figure below shows attempts to sample from a similar model using two different algorithms. HMC (shown in red) fully explores the target, which is only mildly funnel-shaped. However, the Gibbs sampler (blue) fails to explore an entire region of the ``spout'', and will thus produce biased estimates. 
%Moreover, when the output is not in direct comparison with that of another sampler, this bias is very difficult to detect.

\begin{figure}
\includegraphics[width=\twocolwid]{schools_failure1}
\caption{HMC (red) effectively explores the distribution, while the Gibbs sampler (blue) is unable to reach an entire region in the ``spout''.}
\end{figure}

\end{block}
\end{column}
\end{columns}

\end{frame}
\end{document}
