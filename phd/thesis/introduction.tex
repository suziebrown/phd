\chapter{Introduction}

\epigraph{
I wonder why. I wonder why.\\
I wonder why I wonder.\\
I wonder \emph{why} I wonder why\\
I wonder why I wonder!
}
{\textsc{Richard P. Feynman}}

Since their introduction in the 1990s, sequential Monte Carlo (SMC) methods, sometimes known as particle filters, have found applications in virtually every branch of science. 
This is due to the ubiquity of the types of problems in which SMC is most powerful.
As more and more data are collected, and scientific models made ever more complex, practitioners are frequently reaching for numerical methods to solve problems.
If the aim of their analysis is to extract information from sequentially-observed data then SMC is a likely candidate. And there is no shortage of sequential data; consider any scenario in which observations are recorded through time. 
On top of this, SMC is also used as a tool to speed up other numerical methods, by artificially introducing some sequential structure: tempering to enable Monte Carlo sampling from multimodal distributions; constructing nested sequences of events to enable rare event simulation; sequentially decreasing the tolerance level in approximate Bayesian computation.

Almost three decades of study have produced a menagerie of variations on the standard ``bootstrap'' SMC algorithm, along with a deeper understanding of their theoretical underpinnings.
Even so, the problems to which SMC is applied are inherently hard --- after all, Monte Carlo is said to be a last resort for problems too hard to solve in any sensible way --- so it is still found to be lacking in some respects.
One such unresolved issue, which is the primary concern of the current work, is that of ancestral or path degeneracy, which is described in Section~\ref{sec:anc_degen}. Although this problem was noted in the original article on SMC by \textcite{gordon1993}, it still has not been adequately solved.

The current work makes no attempt to solve the problem of ancestral degeneracy. The focus is instead on analysing and quantifying it, using a combination of techniques from the SMC and population genetics literatures. 
The hope is that, equipped with more information about this phenomenon, the practitioner will be able to make better judgements about their choice of algorithm and tuning parameters, and how much trust they should put in the resulting estimates.
\\[10pt]

The bulk of the thesis is divided into four chapters. 
Chapter~\ref{ch:bg} provides the relevant background on sequential Monte Carlo and coalescent theory, and explains in more detail the relevance of genealogies to the study of SMC algorithms.
It also includes a detailed comparison of the most important ``resampling schemes'' in the SMC literature, in terms of various properties of interest. Most of the results included are well-known, but Section~\ref{sec:resampling_properties} provides a more complete summary than can be found elsewhere in the literature.

Chapter~\ref{ch:limits} sets up the framework for the asymptotic analysis of genealogies, and presents the first result (Theorem~\ref{thm:FDDconv}), a sufficient condition for convergence of finite-dimensional distributions to those of Kingman's $n$-coalescent (Section~\ref{sec:KC}). The proof of the theorem builds on a related result of \textcite{koskela2018}, which is reviewed in Section~\ref{sec:existing}.

In Chapter~\ref{ch:weakconv} it is shown that under the same sufficient conditions, the processes under consideration also converge \emph{weakly} to the $n$-coalescent (Theorem~\ref{thm:weakconv}). This is a stronger result than that of Chapter~\ref{ch:limits}, additionally requiring tightness of the processes.

Chapter~\ref{ch:appl} consists of a series of corollaries, each of which verifies the theorem conditions for a particular class of SMC algorithms. This includes the majority of SMC algorithms commonly used by practitioners.

